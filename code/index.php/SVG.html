<html>

<head>
<title>NodeBox | SVG</title>
<meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta http-equiv="imagetoolbar" content="no" />
<meta http-equiv="linode" content="true"/>
<meta name="description" content="" />
<meta name="keywords" content="NodeBox, SVG, SVG, furry, path filter, group transform, illustrator" />
<link rel="alternate" type="application/rss+xml" title="NodeBox News Feed" href="https://nodebox.net/code/data/rss.xml" />
<link rel="canonical" href="https://nodebox.net/code/index.php/SVG" />
<link type="text/css" rel="stylesheet" media="screen" href="../../media/css/nbar.css">

<script type="text/javascript" src="../js/pop.js"></script>
<script type="text/javascript" src="../js/confirm.js"></script>
<link href="../css/default.css" rel="stylesheet" type="text/css" />
<link href="../css/print.css" rel="stylesheet" type="text/css" media="print" />
<!--[if gte IE 5.5]>
<script type="text/javascript" src="/code/js/pngfix.js"></script>
<![endif]-->

<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-1668598-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
</head>

<body id="body" >
<div class="nbar">
  <ol>
    <li><a class="node" href="https://www.nodebox.net/code/">NodeBox 1<span class="nbar-arrow"></span></a>
      <ol class="nbar-dropdown">
        <li><a href="https://www.nodebox.net/">Homepage</a></li>
        <li><a href="https://www.nodebox.net/node/">NodeBox 3<small>Node-based app for generative design and data visualization</small></a></li>
        <li><a href="https://www.nodebox.net/opengl/">NodeBox OpenGL<small>Hardware-accelerated cross-platform graphics library</small></a></li>
        <li><a href="https://www.nodebox.net/code/">NodeBox 1<small>Generate 2D visuals using Python code (Mac OS X only)</small></a></li>
      </ol>
    </li>
    <li><a class="gallery" href="https://www.nodebox.net/gallery/">Gallery</a></li>
    <li><a class="documentation" href="Tutorial.html">Documentation</a></li>
    <li><a class="forum" href="http://support.nodebox.net/discussions">Forum</a></li>
    <li><a class="blog" href="https://www.nodebox.net/blog/">Blog</a></li>
  </ol>
</div>


<div id="all">
<div id="header_and_navigation">

<div id="header">
<a href="Home.html"><img id="header_image" src="../g/header-small.jpg" width="800" /></a></div>

<div id="title">
<a href="Home.html"><h1>NodeBox</h1>
<strong><em>Create visual output with Python programming code</em></strong>
</a></div>

<div id="contextual">
<div id="languages">
 
</div>

<div id="search">
<form id = "sf" method="get">
<input type="text" id="q" name="q" value="" />
<a href="javascript:document.getElementById('sf').submit();">GO</a>
</form>
</div>

</div>

<div id="navigation">
<div id="navigation_public">
<a id="" href="Home.html">Home</a> 
<a id="" href="Download.html">Download</a> 
<a id="" href="Reference.html">Reference</a> 
<a id="" href="Tutorial.html">Tutorial</a> 
<a id="" href="Library.html">Library</a> 
<a id="" href="Gallery.html">Gallery</a> 
<a id="" href="Share.html">Share</a> 
<a id="" href="About.html">About</a> 
</div>
</div>
 
</div>

<div id="content">

<div id="nodebox-link">
<a href="Home.html"><img src="../g/transparent.gif" /></a>
</div>

<div class="inside">
<? if (do_name() != 'Home') : ?>
 <h3>SVG</h3><? endif ?>
<h2>Description</h2>  <p>The SVG library gives control over vector work imported into NodeBox. Rectangles, circles and paths from an SVG file are imported as native NodeBox paths, so their individual points and colors can be manipulated (see the tutorial on <a href="Paths.html">Paths</a>).</p>  <p>&quot;SVG&quot; means Scalable Vector Graphics and is an XML format. You can save SVG files from <a href="http://www.inkscape.org/">Inkscape</a>  and Illustrator. Hand-draw your shapes there and then manipulate them further in NodeBox.</p>  <p>The SVG library has been tested for the following Illustrator functionalities: rectangles, ellipses, polygons, lines, curves constructed with the pen-tool, fill colors, stroke colors, stroke widths and transparency. Complicated things like gradient fills are ignored.</p>  <h2>Download</h2>  <table border="0"><tbody><tr><td><a href="https://www.nodebox.net/code/data/media/svg.zip" target="_self"><img src="../data/media/download.gif" alt="download" /></a></td><td><a href="https://www.nodebox.net/code/data/media/svg.zip">svg.zip</a> (400KB)<br /> <i>Last updated for NodeBox 1.9.4.5<br /></i><i>Licensed under GPL</i><br /><i>Author: Tom De Smedt</i><br /></td></tr></tbody></table>  <h2>Documentation</h2><ul><li><a href="SVG.html#library" target="_self">How to get the library up and running</a></li><li><a href="SVG.html#export" target="_self">Preparing SVG files</a></li><li><a href="SVG.html#parse" target="_self">Importing SVG files</a></li><li><a href="SVG.html#furry" target="_self">A simple path filter</a></li><li><a href="SVG.html#group_transform" target="_self">Transforming a group of paths</a><br /></li></ul><p>&nbsp;</p><hr /><h2><a name="library" title="library"></a>How to get the library up and running</h2><p>Put the <i>svg</i> library folder in the same folder as your script so NodeBox can find the library. You can also put it in ~/Library/Application Support/NodeBox/. </p><pre class="python">svg = <span style="color: #530035;">ximport</span><span style="">&#40;</span><span style="color: #ff0080;">&quot;svg&quot;</span><span style="">&#41;</span></pre></pre></p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                   <hr /><h2><a name="export" title="export"></a>Preparing SVG files</h2><p>To export files as SVG from Adobe Illustrator do the following:</p> <ol> </ol><ol> </ol><ol> </ol><ul><li>Choose File &gt; Save As...</li><li>In the file dialog, select &quot;SVG (svg)&quot; (not &quot;SVG Compressed&quot; - we can&#39;t read compressed files)</li><li>In the next window, choose &quot;SVG Tiny 1.2&quot; as the SVG Profile. <br />The regular SVG format saves all swatches and patterns, which is useless outside of Illustrator. Leave the rest of the settings as-is.</li></ul><ol> </ol> <p><span class="media"><img src="../data/media/svg-export.jpg" /></span> </p> <hr /><h2><a name="parse" title="parse"></a>Importing SVG files</h2><pre class="python">parse<span style="">&#40;</span><span style="">str</span>, cached=<span style="color: #530035;">False</span><span style="">&#41;</span></pre></pre><p>The <i>parse()</i> command reads SVG source and returns a list of <a href="Paths.html" target="_self">paths</a> that are drawable with <a href="Reference_|_drawpath().html" target="_self">drawpath()</a>. The command has an optional <i>cached</i> parameter. When set to <i>True</i>, the SVG source is analyzed only once and the parsed paths stored in memory so they load faster. </p><p>Each returned path in the list has the following properties: </p><ul><li><i>path</i>.closed: is set to True when the path is closed</li><li><i>path</i>.fill: the fill color of the path in the SVG file</li><li><i>path</i>.stroke: the stroke color of the path in the SVG file</li><li><i>path</i>.strokewidth: the stroke width of the path in the SVG file.<br /></li></ul><p>These can be used to copy color information from the original vector drawing. Read the <a href="Paths.html" target="_self">tutorial on paths</a> to see what you can do with the points of a path.</p><p>For example, here&#39;s one of Ludivine Lechat&#39;s Illustrator drawings. We can import the paths into NodeBox. Those that have a fill color will retain their original fill. </p><p>&nbsp;</p><p><span class="media"><img src="../data/media/svg-illustrator.jpg" width="634" height="668" /></span> </p> <pre class="python">data = <span style="color: #530035;">open</span><span style="">&#40;</span><span style="color: #ff0080;">&quot;flower.svg&quot;</span><span style="">&#41;</span>.<span style="">read</span><span style="">&#40;</span><span style="">&#41;</span>
paths = svg.<span style="">parse</span><span style="">&#40;</span>data<span style="">&#41;</span>
&nbsp;
<span style="color: #530035;">for</span> path <span style="color: #530035;">in</span> paths:
  <span style="color: #530035;">try</span>:
    <span style="color: #530035;">fill</span><span style="">&#40;</span>path.<span style="color: #530035;">fill</span><span style="">&#41;</span>
  <span style="color: #530035;">except</span>:
    <span style="color: #530035;">fill</span><span style="">&#40;</span><span style="color: #530035;">random</span><span style="">&#40;</span><span style="">&#41;</span>, <span style="">0</span>, <span style="">0</span><span style="">&#41;</span>
  <span style="color: #530035;">drawpath</span><span style="">&#40;</span>path<span style="">&#41;</span></pre></pre><p><span class="media">In the following example we override the colors in the original document.  We only fill paths that are closed, in shades of the same color:</span></p><p>&nbsp;</p><p><span class="media"><img src="../data/media/svg-nodebox.jpg" width="739" height="647" /></span> </p>  <p>&nbsp;</p><hr /><h2><a name="furry" title="furry"></a>A simple path filter</h2><p>Since all of the imported artwork are standard NodeBox paths, I can also manipulate them with <a href="Path_Mathematics.html" target="_self">path mathematics</a>, transform them like the <a href="LetterKnitter.html">LetterKnitter</a>. After some fumbling with paths and a nice gradient background, here is a hairy version of our flower. The bottom paths are darker to create a sense of depth.  </p><p>&nbsp;</p>  <p><span class="media"><img src="../data/media/svg-pathfilter.jpg" width="739" height="647" /></span> </p>    <p>Below is some example code used to alter the path. <br />You can see it in use in the <a href="Superfolia.html">Superfolia</a> project in the gallery.</p>  <pre class="python"><span style="color: #530035;">def</span> <span style='color:rgb(255,0,50)'>draw_furry</span><span style="">&#40;</span>path<span style="">&#41;</span>:
    prev = <span style="color: #530035;">None</span>
    <span style="color: #530035;">autoclosepath</span><span style="">&#40;</span><span style="color: #530035;">False</span><span style="">&#41;</span>
    <span style="color: #530035;">nofill</span><span style="">&#40;</span><span style="">&#41;</span>
    <span style="color: #530035;">for</span> pt <span style="color: #530035;">in</span> path.<span style="">points</span><span style="">&#40;</span><span style="">100</span><span style="">&#41;</span>:
        <span style="color: #530035;">stroke</span><span style="">&#40;</span><span style="">1</span>, <span style="">0.5</span><span style="">&#41;</span>
        <span style="color: #530035;">strokewidth</span><span style="">&#40;</span><span style="color: #530035;">random</span><span style="">&#40;</span><span style="">0.5</span><span style="">&#41;</span><span style="">&#41;</span>
        <span style="color: #530035;">if</span> prev != <span style="color: #530035;">None</span>:
            <span style="color: #530035;">beginpath</span><span style="">&#40;</span>prev.<span style="">x</span>, prev.<span style="">y</span><span style="">&#41;</span>
            <span style="color: #530035;">curveto</span><span style="">&#40;</span>
                pt.<span style="">ctrl1</span>.<span style="">x</span> - <span style="color: #530035;">random</span><span style="">&#40;</span><span style="">30</span><span style="">&#41;</span>, 
                pt.<span style="">ctrl1</span>.<span style="">y</span>,
                pt.<span style="">ctrl2</span>.<span style="">x</span>, 
                pt.<span style="">ctrl2</span>.<span style="">y</span> + <span style="color: #530035;">random</span><span style="">&#40;</span><span style="">30</span><span style="">&#41;</span>,
                pt.<span style="">x</span>, 
                pt.<span style="">y</span>
            <span style="">&#41;</span>
            <span style="color: #530035;">curveto</span><span style="">&#40;</span>
                pt.<span style="">ctrl1</span>.<span style="">x</span> + <span style="color: #530035;">random</span><span style="">&#40;</span><span style="">10</span><span style="">&#41;</span>, 
                pt.<span style="">ctrl1</span>.<span style="">y</span>,
                pt.<span style="">ctrl2</span>.<span style="">x</span>, 
                pt.<span style="">ctrl2</span>.<span style="">y</span> - <span style="color: #530035;">random</span><span style="">&#40;</span><span style="">10</span><span style="">&#41;</span>,
                pt.<span style="">x</span> + <span style="color: #530035;">random</span><span style="">&#40;</span><span style="">-20</span>, <span style="">20</span><span style="">&#41;</span>, 
                pt.<span style="">y</span> + <span style="color: #530035;">random</span><span style="">&#40;</span><span style="">-20</span>, <span style="">20</span><span style="">&#41;</span>
            <span style="">&#41;</span>
            <span style="color: #530035;">endpath</span><span style="">&#40;</span><span style="">&#41;</span>
        prev = pt</pre></pre>  <p>More path filters can be found <a href="Path_Filters.html" target="_self">here</a>. </p><p>&nbsp;</p><hr width="100%" size="2" /><h2><a title="group_transform" name="group_transform"></a>Transforming a group of paths</h2><p>When you import an SVG file a list of paths is returned. All of these paths may make up a single drawing and you may encounter difficulties when <b>rotating and scaling the drawing a whole</b>. Below are two commands to help you along. </p><p>The first command, <i>bounds()</i>, calculates the position and total size of a list of paths. The second command, <i>drawpaths()</i>, draws all of the paths rotating and scaling from the given origin. By default origin is (0.5, 0.5) which means the center of the group.</p><pre class="python"><span style="color: #530035;">def</span> <span style='color:rgb(255,0,50)'>bounds</span><span style="">&#40;</span>paths=<span style="">&#91;</span><span style="">&#93;</span><span style="">&#41;</span>:
   <span style="color: #ff0080;">&quot;&quot;</span><span style="color: #ff0080;">&quot; Returns (x, y), (width, height) bounds for a group of paths.
   &quot;</span><span style="color: #ff0080;">&quot;&quot;</span>
   <span style="color: #530035;">if</span> <span style="">len</span><span style="">&#40;</span>paths<span style="">&#41;</span> == <span style="">0</span>: 
       <span style="color: #530035;">return</span> <span style="">&#40;</span><span style="">0</span>,<span style="">0</span><span style="">&#41;</span>, <span style="">&#40;</span><span style="">0</span>,<span style="">0</span><span style="">&#41;</span>
   l = t = <span style="">float</span><span style="">&#40;</span><span style="color: #ff0080;">&quot;inf&quot;</span><span style="">&#41;</span>
   r = b = <span style="">float</span><span style="">&#40;</span><span style="color: #ff0080;">&quot;-inf&quot;</span><span style="">&#41;</span>
   <span style="color: #530035;">for</span> path <span style="color: #530035;">in</span> paths:
       <span style="">&#40;</span>x, y<span style="">&#41;</span>, <span style="">&#40;</span>w, h<span style="">&#41;</span> = path.<span style="">bounds</span>
       l = <span style="">min</span><span style="">&#40;</span>l, x<span style="">&#41;</span>
       t = <span style="">min</span><span style="">&#40;</span>t, y<span style="">&#41;</span>
       r = <span style="">max</span><span style="">&#40;</span>r, x+w<span style="">&#41;</span>
       b = <span style="">max</span><span style="">&#40;</span>b, y+h<span style="">&#41;</span>
   <span style="color: #530035;">return</span> <span style="">&#40;</span>l, t<span style="">&#41;</span>, <span style="">&#40;</span>r-l, b-t<span style="">&#41;</span></pre></pre><pre class="python"><span style="color: #530035;">def</span> <span style='color:rgb(255,0,50)'>drawpaths</span><span style="">&#40;</span>paths=<span style="">&#91;</span><span style="">&#93;</span>, x=<span style="">0</span>, y=<span style="">0</span>, <span style="color: #530035;">rotate</span>=<span style="">0</span>, <span style="color: #530035;">scale</span>=<span style="">1.0</span>, origin=<span style="">&#40;</span><span style="">0.5</span>,<span style="">0.5</span><span style="">&#41;</span><span style="">&#41;</span>:
   <span style="color: #ff0080;">&quot;&quot;</span><span style="color: #ff0080;">&quot; Draws a group of paths that rotate and scale from the given origin.
   &quot;</span><span style="color: #ff0080;">&quot;&quot;</span>
   _ctx.<span style="color: #530035;">transform</span><span style="">&#40;</span>CORNER<span style="">&#41;</span>
   _ctx.<span style="color: #530035;">push</span><span style="">&#40;</span><span style="">&#41;</span>
   _ctx.<span style="color: #530035;">translate</span><span style="">&#40;</span>x, y<span style="">&#41;</span>
   _ctx.<span style="color: #530035;">rotate</span><span style="">&#40;</span><span style="color: #530035;">rotate</span><span style="">&#41;</span>
   _ctx.<span style="color: #530035;">scale</span><span style="">&#40;</span><span style="color: #530035;">scale</span><span style="">&#41;</span>
   <span style="">&#40;</span>x, y<span style="">&#41;</span>, <span style="">&#40;</span>w, h<span style="">&#41;</span> = bounds<span style="">&#40;</span>paths<span style="">&#41;</span>
   _ctx.<span style="color: #530035;">translate</span><span style="">&#40;</span><span style="">&#40;</span>-x-w<span style="">&#41;</span>*origin<span style="">&#91;</span><span style="">0</span><span style="">&#93;</span>, <span style="">&#40;</span>-y-h<span style="">&#41;</span>*origin<span style="">&#91;</span><span style="">1</span><span style="">&#93;</span><span style="">&#41;</span>
   <span style="color: #530035;">for</span> path <span style="color: #530035;">in</span> paths:
       <span style="color: grey;">#_ctx.fill(path.fill)</span>
       <span style="color: grey;">#_ctx.stroke(path.stroke)</span>
       <span style="color: grey;">#_ctx.strokewidth(path.strokewidth)</span>
       <span style="color: grey;"># Use copies of the paths that adhere to the transformations.</span>
       _ctx.<span style="color: #530035;">drawpath</span><span style="">&#40;</span>path.<span style="">copy</span><span style="">&#40;</span><span style="">&#41;</span><span style="">&#41;</span>
   _ctx.<span style="color: #530035;">pop</span><span style="">&#40;</span><span style="">&#41;</span></pre></pre></p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <hr /><p>Finally, remember that when you want to supply one path multiple times to drawpath(), each with its own translation and rotation, you need to<b> feed copies of the path to drawpath</b>: </p><pre class="python">path = svg.<span style="">parse</span><span style="">&#40;</span>data<span style="">&#41;</span><span style="">&#91;</span><span style="">0</span><span style="">&#93;</span>
<span style="color: #530035;">for</span> i <span style="color: #530035;">in</span> <span style="">range</span><span style="">&#40;</span><span style="">5</span><span style="">&#41;</span>:
  <span style="color: #530035;">rotate</span><span style="">&#40;</span>i*<span style="">10</span><span style="">&#41;</span>
  <span style="color: #530035;">drawpath</span><span style="">&#40;</span>path.<span style="">copy</span><span style="">&#40;</span><span style="">&#41;</span><span style="">&#41;</span></pre></pre> <p>&nbsp;</p><? include("util/comment.php"); ?>
</div>
  
</div>

<div id="footer">
Last modified: Dec 11 2009 | &copy; 2004-2012 <a href="http://www.emrg.be/" class="noexternal">Experimental Media Research Group</a>
</div>
<img src="../g/footer.jpg" style="border:0" class="footer" width="800" height="334" />

</div>

<script>
try{e=document.getElementsByTagName("span");for(i=0;i<e.length;i++){if(e[i].className=="header_image"){src=e[i].getElementsByTagName("img")[0].src;document.getElementById("header_image").src=src;break;}}}catch(e){}
</script>
</body>

</html>