<html>

<head>
<title>NodeBox | Console</title>
<meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta http-equiv="imagetoolbar" content="no" />
<meta http-equiv="linode" content="true"/>
<meta name="description" content="" />
<meta name="keywords" content="NodeBox, Console, " />
<link rel="alternate" type="application/rss+xml" title="NodeBox News Feed" href="https://nodebox.net/code/data/rss.xml" />
<link rel="canonical" href="https://nodebox.net/code/index.php/Console" />
<link type="text/css" rel="stylesheet" media="screen" href="../../media/css/nbar.css">

<script type="text/javascript" src="../js/pop.js"></script>
<script type="text/javascript" src="../js/confirm.js"></script>
<link href="../css/default.css" rel="stylesheet" type="text/css" />
<link href="../css/print.css" rel="stylesheet" type="text/css" media="print" />
<!--[if gte IE 5.5]>
<script type="text/javascript" src="/code/js/pngfix.js"></script>
<![endif]-->

<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-1668598-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
</head>

<body id="body" >
<div class="nbar">
  <ol>
    <li><a class="node" href="https://www.nodebox.net/code/">NodeBox 1<span class="nbar-arrow"></span></a>
      <ol class="nbar-dropdown">
        <li><a href="https://www.nodebox.net/">Homepage</a></li>
        <li><a href="https://www.nodebox.net/node/">NodeBox 3<small>Node-based app for generative design and data visualization</small></a></li>
        <li><a href="https://www.nodebox.net/opengl/">NodeBox OpenGL<small>Hardware-accelerated cross-platform graphics library</small></a></li>
        <li><a href="https://www.nodebox.net/code/">NodeBox 1<small>Generate 2D visuals using Python code (Mac OS X only)</small></a></li>
      </ol>
    </li>
    <li><a class="gallery" href="https://www.nodebox.net/gallery/">Gallery</a></li>
    <li><a class="documentation" href="Tutorial.html">Documentation</a></li>
    <li><a class="forum" href="http://support.nodebox.net/discussions">Forum</a></li>
    <li><a class="blog" href="https://www.nodebox.net/blog/">Blog</a></li>
  </ol>
</div>


<div id="all">
<div id="header_and_navigation">

<div id="header">
<a href="Home.html"><img id="header_image" src="../g/header-small.jpg" width="800" /></a></div>

<div id="title">
<a href="Home.html"><h1>NodeBox</h1>
<strong><em>Create visual output with Python programming code</em></strong>
</a></div>

<div id="contextual">
<div id="languages">
 
</div>

<div id="search">
<form id = "sf" method="get">
<input type="text" id="q" name="q" value="" />
<a href="javascript:document.getElementById('sf').submit();">GO</a>
</form>
</div>

</div>

<div id="navigation">
<div id="navigation_public">
<a id="" href="Home.html">Home</a> 
<a id="" href="Download.html">Download</a> 
<a id="" href="Reference.html">Reference</a> 
<a id="" href="Tutorial.html">Tutorial</a> 
<a id="" href="Library.html">Library</a> 
<a id="" href="Gallery.html">Gallery</a> 
<a id="" href="Share.html">Share</a> 
<a id="" href="About.html">About</a> 
</div>
</div>
 
</div>

<div id="content">

<div id="nodebox-link">
<a href="Home.html"><img src="../g/transparent.gif" /></a>
</div>

<div class="inside">
<? if (do_name() != 'Home') : ?>
 <h3>Console</h3><? endif ?>
<h1>Using NodeBox in another application</h1>
<p>The NodeBox core is now split off from the UI functionality, so you can use it in any project. There are a few different ways of using NodeBox.</p>
<h2>1. The easy way: from NodeBox itself</h2>
<p>One of the new features in NodeBox is that you can access the canvas object. It's a list-like structure, containing all your graphical objects ("grobs"). The canvas also has a "save" method, so anywhere in your script you can do:</p>
<pre class="python">canvas.<span style="">save</span><span style="">&#40;</span><span style="color: #ff0080;">&quot;partial.pdf&quot;</span><span style="">&#41;</span></pre></pre>
<p>And it will save what it has drawn <em>up until that point.</em> Do it at the end of your script, and you get the full output.</p>
<p>After saving, you might want to clear out the canvas. You can:</p>
<pre class="python">canvas.<span style="">clear</span><span style="">&#40;</span><span style="">&#41;</span></pre></pre>
<p>This will remove all grobs already on the canvas; they will not show up in the render.</p>
<h2>2. Installing the NodeBox module</h2>
<p>If you want to use NodeBox from the command line, you will have to install it. We currently recommend using <a href="http://subversion.tigris.org/" target="_blank" title="Subversion">Subversion</a> to grab a copy:</p>
<pre class="python">svn co http://dev.<span style="">nodebox</span>.<span style="">net</span>/svn/nodebox/trunk/ nodebox
<span style="">cd</span> libs/Numeric
python setup.<span style="">py</span> install
<span style="">cd</span> ../..
&nbsp;
<span style="">cd</span> libs/pathmatics
python setup.<span style="">py</span> install
<span style="">cd</span> ../..
&nbsp;
<span style="">cd</span> libs/polymagic
python setup.<span style="">py</span> install
<span style="">cd</span> ../..
&nbsp;
<span style="">cd</span> src
python setup.<span style="">py</span> install</pre></pre>
<p>The only outside dependency is <a href="http://pyobjc.sourceforge.net/" target="_blank" title="PyObjC">PyObjC</a>. We recommend the latest version from Subversion.</p>
<h2>3. Using the console runner</h2>
<p>When you have a set of NodeBox scripts that you want to run to generate images or a movie, use the following commands:</p>
<pre class="python"><span style="color: #530035;">from</span> nodebox <span style="color: #530035;">import</span> console
source = <span style="color: #ff0080;">&quot;size(200,200)<span style="">\n</span>rect(random(WIDTH), random(HEIGHT), 20, 20)&quot;</span>
console.<span style="">make_image</span><span style="">&#40;</span>source, <span style="color: #ff0080;">&quot;rect.png&quot;</span><span style="">&#41;</span>
console.<span style="">make_movie</span><span style="">&#40;</span>source, <span style="color: #ff0080;">&quot;rect.mov&quot;</span>, <span style="">20</span>, fps=<span style="">30</span><span style="">&#41;</span></pre></pre>
<p>Currently, there is no way to run the console from the command line, but we're working on that.</p>
<h2>4. Accessing the context directly</h2>
<p>If you want to have direct access to NodeBox's drawing context, you can import everything directly. The API remains the same, but you have to prefix everything with the context. Note also the initialization of Cocoa, necessary for using the API.</p>
<pre class="python"><span style="color: #530035;">from</span> AppKit <span style="color: #530035;">import</span> NSApplication
NSApplication.<span style="">sharedApplication</span><span style="">&#40;</span><span style="">&#41;</span>.<span style="">activateIgnoringOtherApps_</span><span style="">&#40;</span><span style="">0</span><span style="">&#41;</span>
&nbsp;
<span style="color: #530035;">from</span> nodebox.<span style="">graphics</span> <span style="color: #530035;">import</span> Context
<span style="color: #530035;">from</span> nodebox.<span style="">util</span> <span style="color: #530035;">import</span> <span style="color: #530035;">random</span>, <span style="color: #530035;">choice</span>, <span style="color: #530035;">grid</span>, <span style="color: #530035;">files</span>
ctx = Context<span style="">&#40;</span><span style="">&#41;</span>
ctx.<span style="color: #530035;">size</span><span style="">&#40;</span><span style="">200</span>, <span style="">200</span><span style="">&#41;</span>
ctx.<span style="color: #530035;">rect</span><span style="">&#40;</span><span style="color: #530035;">random</span><span style="">&#40;</span>ctx.<span style="color: #530035;">WIDTH</span><span style="">&#41;</span>, <span style="color: #530035;">random</span><span style="">&#40;</span>ctx.<span style="color: #530035;">HEIGHT</span><span style="">&#41;</span>, <span style="">100</span>, <span style="">100</span><span style="">&#41;</span>
ctx.<span style="">save</span><span style="">&#40;</span><span style="color: #ff0080;">&quot;test.png&quot;</span><span style="">&#41;</span></pre></pre>
<p>You can also make movies this way:</p>
<pre class="python"><span style="color: #530035;">from</span> AppKit <span style="color: #530035;">import</span> NSApplication
NSApplication.<span style="">sharedApplication</span><span style="">&#40;</span><span style="">&#41;</span>.<span style="">activateIgnoringOtherApps_</span><span style="">&#40;</span><span style="">0</span><span style="">&#41;</span>
&nbsp;
<span style="color: #530035;">from</span> nodebox.<span style="">graphics</span> <span style="color: #530035;">import</span> Context
<span style="color: #530035;">from</span> nodebox.<span style="">util</span> <span style="color: #530035;">import</span> <span style="color: #530035;">random</span>, <span style="color: #530035;">choice</span>, <span style="color: #530035;">grid</span>, <span style="color: #530035;">files</span>
<span style="color: #530035;">from</span> nodebox.<span style="">util</span>.<span style="">QTSupport</span> <span style="color: #530035;">import</span> Movie
&nbsp;
movie = Movie<span style="">&#40;</span><span style="color: #ff0080;">&quot;rects.mov&quot;</span><span style="">&#41;</span>
<span style="color: #530035;">for</span> i <span style="color: #530035;">in</span> <span style="">range</span><span style="">&#40;</span><span style="">10</span><span style="">&#41;</span>:
   ctx = Context<span style="">&#40;</span><span style="">&#41;</span>
    ctx.<span style="color: #530035;">size</span><span style="">&#40;</span><span style="">200</span>, <span style="">200</span><span style="">&#41;</span>
 ctx.<span style="color: #530035;">rect</span><span style="">&#40;</span><span style="color: #530035;">random</span><span style="">&#40;</span>ctx.<span style="color: #530035;">WIDTH</span><span style="">&#41;</span>, <span style="color: #530035;">random</span><span style="">&#40;</span>ctx.<span style="color: #530035;">HEIGHT</span><span style="">&#41;</span>, <span style="">100</span>, <span style="">100</span><span style="">&#41;</span>
  movie.<span style="">add</span><span style="">&#40;</span>ctx<span style="">&#41;</span>
movie.<span style="">save</span><span style="">&#40;</span><span style="">&#41;</span></pre></pre>
<h2>5. Drawing in a Cocoa drawRect method</h2>
<p>If you want to implement your existing drawing using NodeBox, you can do the following in your class's drawRect: method:</p>
<pre class="python"><span style="color: #530035;">def</span> <span style='color:rgb(255,0,50)'>drawRect_</span><span style="">&#40;</span><span style="">self</span>, <span style="color: #530035;">rect</span><span style="">&#41;</span>:
    <span style="color: #530035;">from</span> nodebox.<span style="">graphics</span> <span style="color: #530035;">import</span> Context
   <span style="color: #530035;">from</span> nodebox.<span style="">util</span> <span style="color: #530035;">import</span> <span style="color: #530035;">random</span>
    ctx.<span style="color: #530035;">size</span><span style="">&#40;</span>*<span style="color: #530035;">rect</span><span style="">&#91;</span><span style="">1</span><span style="">&#93;</span><span style="">&#41;</span>
 ctx.<span style="color: #530035;">rect</span><span style="">&#40;</span><span style="color: #530035;">random</span><span style="">&#40;</span>ctx.<span style="color: #530035;">WIDTH</span><span style="">&#41;</span>, <span style="color: #530035;">random</span><span style="">&#40;</span>ctx.<span style="color: #530035;">HEIGHT</span><span style="">&#41;</span>, <span style="">100</span>, <span style="">100</span><span style="">&#41;</span>
  ctx.<span style="">canvas</span>.<span style="">draw</span><span style="">&#40;</span><span style="">&#41;</span></pre></pre>
<p>Note that creating the Context and drawing it are two separate steps:</p>
<ul>
<li>First, the context is created; all drawing commands are translated into graphic objects ("grobs") that are stored on the canvas.</li>
<li>Then, the canvas is drawn; each grob now renders itself on the current Cocoa graphics context.</li>
</ul>
<p>This also means you can cache the context (or the canvas) and use it in a drawRect method during a later stage.</p><? include("util/comment.php"); ?>
</div>
  
</div>

<div id="footer">
Last modified: Mar 19 2008 | &copy; 2004-2012 <a href="http://www.emrg.be/" class="noexternal">Experimental Media Research Group</a>
</div>
<img src="../g/footer.jpg" style="border:0" class="footer" width="800" height="334" />

</div>

<script>
try{e=document.getElementsByTagName("span");for(i=0;i<e.length;i++){if(e[i].className=="header_image"){src=e[i].getElementsByTagName("img")[0].src;document.getElementById("header_image").src=src;break;}}}catch(e){}
</script>
</body>

</html>