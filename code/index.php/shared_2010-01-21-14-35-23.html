<html>

<head>
<title>NodeBox | ouputmode(CMYK) not working?</title>
<meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta http-equiv="imagetoolbar" content="no" />
<meta http-equiv="linode" content="true"/>
<meta name="description" content="" />
<meta name="keywords" content="NodeBox, shared 2010-01-21-14-35-23, colors" />
<link rel="alternate" type="application/rss+xml" title="NodeBox News Feed" href="https://nodebox.net/code/data/rss.xml" />
<link rel="canonical" href="https://nodebox.net/code/index.php/shared_2010-01-21-14-35-23" />
<link type="text/css" rel="stylesheet" media="screen" href="../../media/css/nbar.css">

<script type="text/javascript" src="../js/pop.js"></script>
<script type="text/javascript" src="../js/confirm.js"></script>
<link href="../css/default.css" rel="stylesheet" type="text/css" />
<link href="../css/print.css" rel="stylesheet" type="text/css" media="print" />
<!--[if gte IE 5.5]>
<script type="text/javascript" src="/code/js/pngfix.js"></script>
<![endif]-->

<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-1668598-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
</head>

<body id="body" >
<div class="nbar">
  <ol>
    <li><a class="node" href="https://www.nodebox.net/code/">NodeBox 1<span class="nbar-arrow"></span></a>
      <ol class="nbar-dropdown">
        <li><a href="https://www.nodebox.net/">Homepage</a></li>
        <li><a href="https://www.nodebox.net/node/">NodeBox 3<small>Node-based app for generative design and data visualization</small></a></li>
        <li><a href="https://www.nodebox.net/opengl/">NodeBox OpenGL<small>Hardware-accelerated cross-platform graphics library</small></a></li>
        <li><a href="https://www.nodebox.net/code/">NodeBox 1<small>Generate 2D visuals using Python code (Mac OS X only)</small></a></li>
      </ol>
    </li>
    <li><a class="gallery" href="https://www.nodebox.net/gallery/">Gallery</a></li>
    <li><a class="documentation" href="Tutorial.html">Documentation</a></li>
    <li><a class="forum" href="http://support.nodebox.net/discussions">Forum</a></li>
    <li><a class="blog" href="https://www.nodebox.net/blog/">Blog</a></li>
  </ol>
</div>


<div id="all">
<div id="header_and_navigation">

<div id="header">
<a href="Home.html"><img id="header_image" src="../g/header-small.jpg" width="800" /></a></div>

<div id="title">
<a href="Home.html"><h1>NodeBox</h1>
<strong><em>Create visual output with Python programming code</em></strong>
</a></div>

<div id="contextual">
<div id="languages">
 
</div>

<div id="search">
<form id = "sf" method="get">
<input type="text" id="q" name="q" value="" />
<a href="javascript:document.getElementById('sf').submit();">GO</a>
</form>
</div>

</div>

<div id="navigation">
<div id="navigation_public">
<a id="" href="Home.html">Home</a> 
<a id="" href="Download.html">Download</a> 
<a id="" href="Reference.html">Reference</a> 
<a id="" href="Tutorial.html">Tutorial</a> 
<a id="" href="Library.html">Library</a> 
<a id="" href="Gallery.html">Gallery</a> 
<a id="" href="Share.html">Share</a> 
<a id="" href="About.html">About</a> 
</div>
</div>
 
</div>

<div id="content">

<div id="nodebox-link">
<a href="Home.html"><img src="../g/transparent.gif" /></a>
</div>

<div class="inside">
<? if (do_name() != 'Home') : ?>
 <? endif ?>
<br /><div class="comment"><h1 id="shared-title">ouputmode(CMYK) not working?</h1>
<strong>Posted by <span class="comment_by">rasnab</span> on <em class="date">Jan 21, 2010</em></strong>
<p>Hi! 
<br>
<br>I 'm using Nodebox version 1.9.5 on Snow Leopard.
<br>
<br>Im not able to export CMYK PDF's, EPS or even TIF's correctly.. Im using cmyk values in nodebox, and they look about right on the screen inside nodebox, but the CMYK-values in the exported files dont correspond to the values i've used in the script..
<br>
<br>And yes, the first two lines of my script say:
<br>colormode(CMYK)
<br>outputmode(CMYK)
<br>
<br>Should these commands be placed somewhere else, or does the problem lie somewhere else?
<br>
<br>I would really like to be able to use these PDF:s directly in layouts..
<br>
<br>A short example of what im doing:
<br>----------
<br>colors = ximport("colors")
<br>colormode(CMYK)
<br>outputmode(CMYK)
<br>
<br>black = colors.cmyk(0, 0, 0, 1)
<br>red = colors.cmyk(0, 0.9, 0.65, 0)
<br>
<br>clrs = colors.list(black, red)
<br>
<br>for i in range(100):
<br>    clr = choice(clrs)
<br>    fill(clr)
<br>    rect(0, 0, random(400), 400)
<br>
<br>-------- </b></i></a></ul></li></pre></p><br /></div>
Â <hr /><div class='comment'><strong>Posted by <span class="comment_by">rasnab</span> on <em class="date">Jan 21, 2010</em></strong><p>Just found this out: 
<br>inserting the command<pre class="python"><span style="color: #530035;">print</span> red</pre></pre>outputs:
<br>Color(0.735, 0.279, 0.300, 1.000)
<br>
<br>Which looks like RGB to me.. Even though colormode has been set to CMYK? </b></i></a></ul></li></pre></p><br /></div><hr /><div class='comment'><strong>Posted by <span class="comment_by">Josh Caswell</span> on <em class="date">Jan 21, 2010</em></strong><p>Printing a color always shows you the RGB values, no matter how you defined it in the first place. That's just the way they made the Color object for NB; it is still keeping track of CMYK values. You can get the individual components with red.c, red.m, red.y, red.k
<br>
<br>Is it possible that your viewing program is using a non-default color space? This is definitely not an area that I have a lot of knowledge in, but NB's colors use NSColor, and they are using NSDeviceCMYKColorSpace, which means the colors are specific to the device they are created on. They will appear differently in different color spaces. You probably know much more about that than I do. 
<br>
<br>I've just spent a little time monkeying around with NSColorSpace and friends, and it doesn't look easy to get a generic color space. The one thing I've found that may work:<pre class="python"><span style="color: #530035;">from</span> AppKit <span style="color: #530035;">import</span> *
colors = <span style="color: #530035;">ximport</span><span style="">&#40;</span><span style="color: #ff0080;">&quot;colors&quot;</span><span style="">&#41;</span> 
<span style="color: #530035;">colormode</span><span style="">&#40;</span><span style="color: #530035;">CMYK</span><span style="">&#41;</span> 
outputmode<span style="">&#40;</span><span style="color: #530035;">CMYK</span><span style="">&#41;</span> 
&nbsp;
red = colors.<span style="">cmyk</span><span style="">&#40;</span><span style="">0</span>, <span style="">0.9</span>, <span style="">0.65</span>, <span style="">0</span><span style="">&#41;</span>
red = red.<span style="">nsColor</span>.<span style="">colorUsingColorSpace_</span><span style="">&#40;</span>NSColorSpace.<span style="">genericCMYKColorSpace</span><span style="">&#40;</span><span style="">&#41;</span><span style="">&#41;</span></pre></pre>The first line that I added gives the script access to Cocoa objects by name, which we need to use NSColorSpace, and the last line asks red's underlying NSColor to convert itself to a device-indepent CMYK version, then re-assigns the result to red. I hope that does it.
<br>
<br>If it doesn't, you may have to convert the output file to a different color space using your viewing program, or Photoshop, or something along those lines.
<br>
<br>If you want to dive in to the gritty details about how Cocoa deals with color, you can read <a href="http://developer.apple.com/mac/library/documentation/cocoa/Conceptual/DrawColor/DrawColor.html">Apple's docs</a>. </b></i></a></ul></li></pre></p><br /></div><hr /><div class='comment'><strong>Posted by <span class="comment_by">Josh Caswell</span> on <em class="date">Jan 21, 2010</em></strong><p>Please note that when I said "Printing a color always shows you the RGB. . ." I meant using the Python<pre class="python"><span style="color: #530035;">print</span></pre></pre>statement to output a text representation of a variable. </b></i></a></ul></li></pre></p><br /></div><hr /><div class='comment'><strong>Posted by <span class="comment_by">rasnab</span> on <em class="date">Jan 22, 2010</em></strong><p>Thank you for the detailed answer! Will look into this and see if it helps.. 
<br>
<br>Basically, what I've done is open the generated PDF and EPS files with Acrobat and used "output preview" to check the cmyk values  - which, as i wrote, are not the same as i input in the code. Just to clarify.. The exact values are important, because I was thinking to use this in some corporate identity related print material..
<br>
<br>Thanks,  I'll tell you how it works out.. </b></i></a></ul></li></pre></p><br /></div><hr /><div class='comment'><strong>Posted by <span class="comment_by">rasnab</span> on <em class="date">Jan 22, 2010</em></strong><p>Using colorspace didnt help. Cmyk values are right inside nodebox.
<br>
<br>Im not a programmer, but guessing the colors change somewhere in the export to pdf -phase.. Any way to export manually from code? </b></i></a></ul></li></pre></p><br /></div><hr /><div class='comment'><strong>Posted by <span class="comment_by">anonymous</span> on <em class="date">Jan 24, 2010</em></strong><p>you can save manually from the code:<pre class="python">canvas.<span style="">save</span><span style="">&#40;</span><span style="color: #ff0080;">&quot;export.pdf&quot;</span><span style="">&#41;</span></pre></pre></b></i></a></ul></li></pre></p><br /></div><hr /><div class='comment'><strong>Posted by <span class="comment_by">Josh Caswell</span> on <em class="date">Jan 24, 2010</em></strong><p>There is, as noted by anonymous, but I don't know if it'll make a difference. I'm pretty sure that the menu item calls that same function. Take a look at the <a href="http://nodebox.net/code/index.php/Core_Image#export_the_canvas">coreimage library</a> docs. 
<br>
<br>I thought I had one other thing to try, but I can't get it to work. It was deepish hacking anyways, probably the wrong direction. I can't help feeling there's something obvious that I'm missing. Like I said, colors aren't my strong suit. Out of curiosity, do the values of:<pre class="python">black = colors.<span style="">cmyk</span><span style="">&#40;</span><span style="">0</span>, <span style="">0</span>, <span style="">0</span>, <span style="">1</span><span style="">&#41;</span></pre></pre>change?
<br>
<br>Wish I could be more helpful. </b></i></a></ul></li></pre></p><br /></div><hr /><div class='comment'><strong>Posted by <span class="comment_by">rasnab</span> on <em class="date">Jan 25, 2010</em></strong><p>Hi! Thanks for the help so far..
<br>
<br>I tried what you suggested:
<br>cyan = colors.cmyk(1, 0, 0, 0)
<br>
<br>But that also comes out as [89%, 6%, 4%, 1%]..
<br>
<br>the following:<pre class="python">canvas = coreimage.<span style="">canvas</span><span style="">&#40;</span><span style="">150</span>, <span style="">150</span><span style="">&#41;</span>
l = canvas.<span style="">append</span><span style="">&#40;</span><span style="color: #530035;">color</span><span style="">&#40;</span><span style="">1</span>,<span style="">0</span>,<span style="">0</span>,<span style="">0</span><span style="">&#41;</span><span style="">&#41;</span>
canvas.<span style="">export</span><span style="">&#40;</span><span style="color: #ff0080;">&quot;cyan.tif&quot;</span>, cmyk=<span style="color: #530035;">True</span>, compression=<span style="color: #530035;">True</span><span style="">&#41;</span></pre></pre>produces a TIF where the cmyk is wrong also ([64%, 11%, 1%, 1%])..
<br>
<br>This is unfortunate.. One of the major potentials in Nodebox for me was the ability to produce print-ready CMYK PDF-files.. Anyone know of any alternative software for this? Processing doesnt seem to be able to handle Cmyk either.. </b></i></a></ul></li></pre></p><br /></div><hr /><div class='comment'><strong>Posted by <span class="comment_by">Josh Caswell</span> on <em class="date">Jan 28, 2010</em></strong><p>Okay, a few more things to try, if you're inclined, though I'm not hopeful.
<br>
<br>I noticed while fooling around with HSB colors, the output was more accurate if I didn't call outputmode(HSB). It doesn't make sense, but it may be worth a stab for you to not call outputmode(CMYK). Also, although the file format may not be any use, .tiff seemed to have more accurate HSB and CMYK values.
<br>
<br>One other thing is that you can try is bypassing NB's color (although NB just uses NSColor anyways), like this:<pre class="python"><span style="color: #530035;">from</span> AppKit <span style="color: #530035;">import</span> *
&nbsp;
red = NSColor.<span style="">colorWithDeviceCyan_magenta_yellow_black_alpha_</span><span style="">&#40;</span><span style="">0</span>, <span style="">0.9</span>, <span style="">0.65</span>, <span style="">0</span>, <span style="">1.0</span><span style="">&#41;</span>
&nbsp;
<span style="color: grey;"># try it with and without this line?</span>
red = red.<span style="">colorUsingColorSpace_</span><span style="">&#40;</span>NSColorSpace.<span style="">genericCMYKColorSpace</span><span style="">&#40;</span><span style="">&#41;</span><span style="">&#41;</span>
&nbsp;
<span style="color: #530035;">fill</span><span style="">&#40;</span>red<span style="">&#41;</span>
<span style="color: grey;"># etc. . .</span></pre></pre>Overall, I'm pretty well stumped by this. It's possible that one of the developers can help if you email them, although I know they're pretty busy with NB2.
<br>
<br>Good luck! </b></i></a></ul></li></pre></p><br /></div><hr /><div class='comment'><strong>Posted by <span class="comment_by">Josh Caswell</span> on <em class="date">Jan 28, 2010</em></strong><p>Oh, sorry, I forgot that you had already tried .tiff and it didn't come out right. </b></i></a></ul></li></pre></p><br /></div><hr /><div class='comment'><strong>Posted by <span class="comment_by">rasnab</span> on <em class="date">Jan 28, 2010</em></strong><p>Thanks a lot for your help. 
<br>
<br>Tried your suggestion + a lot of different combinations of setting colormodes & file-formats.
<br>
<br>Results are always off, sometimes less, sometimes more (5-10% / value).
<br>
<br>I give up. I'll look into if theres some "post-processing" I can do in other software to correct the colors.
<br>
<br>I think I'll mail the developers also - if they could get this + PMS-color support : ) into NB2 then it would be quite something for us working with print!
<br>
<br>Thanks. </b></i></a></ul></li></pre></p><br /></div><? include("util/comment.php"); ?>
</div>
  
</div>

<div id="footer">
Last modified: May 29 2012 | &copy; 2004-2012 <a href="http://www.emrg.be/" class="noexternal">Experimental Media Research Group</a>
</div>
<img src="../g/footer.jpg" style="border:0" class="footer" width="800" height="334" />

</div>

<script>
try{e=document.getElementsByTagName("span");for(i=0;i<e.length;i++){if(e[i].className=="header_image"){src=e[i].getElementsByTagName("img")[0].src;document.getElementById("header_image").src=src;break;}}}catch(e){}
</script>
</body>

</html>